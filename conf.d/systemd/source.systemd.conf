# Example:
# 2015-12-21 23:17:22,066 [salt.state       ][INFO    ] Completed state [net.ipv4.ip_forward] at time 23:17:22.066081
<source>
  @type systemd
  filters [{"_SYSTEMD_UNIT": "salt.service" }]
  pos_file /mnt/pos/ggcp-salt.pos
  tag salt
</source>

<filter salt.**>
  @type kubernetes_sumologic
  source_category salt
  source_name k8s_salt
  source_category_prefix "#{ENV['SOURCE_CATEGORY_PREFIX']}"
  exclude_namespace_regex "#{ENV['EXCLUDE_NAMESPACE_REGEX']}"
  exclude_unit_regex "#{ENV['EXCLUDE_UNIT_REGEX']}"
</filter>


# Multi-line parsing is required for all the kube logs because very large log
# statements, such as those that include entire object bodies, get split into
# multiple lines by glog.

# Example:
# I0204 07:32:30.020537    3368 server.go:1048] POST /stats/container/: (13.972191ms) 200 [[Go-http-client/1.1] 10.244.1.3:40537]
<source>
  @type systemd
  filters [{"_SYSTEMD_UNIT": "kubelet.service"}]
  pos_file /mnt/pos/ggcp-kubelet.log.pos
  tag kubelet
</source>

<filter kubelet.**>
  @type kubernetes_sumologic
  source_category kubelet
  source_name k8s_kubelet
  source_category_prefix "#{ENV['SOURCE_CATEGORY_PREFIX']}"
  exclude_namespace_regex "#{ENV['EXCLUDE_NAMESPACE_REGEX']}"
  exclude_unit_regex "#{ENV['EXCLUDE_UNIT_REGEX']}"
</filter>

<source>
  @type systemd
  filters [{"_SYSTEMD_UNIT": "efs.service"}]
  pos_file /mnt/pos/efs.log.pos
  tag efs
</source>

<filter efs.**>
  @type kubernetes_sumologic
  source_category system
  source_name efs
  source_category_prefix "#{ENV['SOURCE_CATEGORY_PREFIX']}"
  exclude_unit_regex "#{ENV['EXCLUDE_UNIT_REGEX']}"
</filter>

<source>
  @type systemd
  filters [{"_SYSTEMD_UNIT": "rpc-statd.service"}]
  pos_file /mnt/pos/rpc-statd.log.pos
  tag rpc-statd
</source>

<filter rpc-statd.**>
  @type kubernetes_sumologic
  source_category system
  source_name rpc-statd
  source_category_prefix "#{ENV['SOURCE_CATEGORY_PREFIX']}"
  exclude_unit_regex "#{ENV['EXCLUDE_UNIT_REGEX']}"
</filter>

<source>
  @type systemd
  filters [{"_SYSTEMD_UNIT": "flanneld.service"}]
  pos_file /mnt/pos/flanneld.log.pos
  tag flanneld
</source>

<filter flanneld.**>
  @type kubernetes_sumologic
  source_category system
  source_name flanneld
  source_category_prefix "#{ENV['SOURCE_CATEGORY_PREFIX']}"
  exclude_unit_regex "#{ENV['EXCLUDE_UNIT_REGEX']}"
</filter>
